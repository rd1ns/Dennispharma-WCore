@inject SeoSettings _seoSettings
@inject IWebHelper _webHelper
@inject WCore.Core.IWorkContext _workContext

@model SkiSchoolModel
@{
    ViewBag.Title = Model.Title;
    ViewBag.MetaTitle = Model.MetaTitle;
    ViewBag.MetaKeywords = Model.MetaKeywords;
    ViewBag.MetaDescription = Model.MetaDescription;

    @if (_seoSettings.TwitterMetaTags)
    {
        ViewBag.TwtterCard = "";
        ViewBag.TwtterTitle = Model.MetaTitle;
        ViewBag.TwtterDescription = Model.MetaDescription;
        ViewBag.TwtterUrl = _webHelper.GetThisPageUrl(true);
        ViewBag.TwtterImage = Model.Image;
    }

    @if (_seoSettings.OpenGraphMetaTags)
    {
        ViewBag.OgTitle = Model.MetaTitle;
        ViewBag.OgDescription = Model.MetaDescription;
        ViewBag.OgUrl = _webHelper.GetStoreLocation();
        ViewBag.OgImage = Model.Image;
    }

    ViewBag.Page = "SkiSchool";
    ViewBag.Collapse = "Show";
}
<main>
    <section class="hero_in hotels_detail">
        <div class="wrapper">
            <div class="container">
                <h1 class="fadeInUp"><span></span>@Model.Title</h1>
            </div>
            <span class="magnific-gallery">
                <a href="/panagea/img/gallery/hotel_list_1.jpg" class="btn_photos" title="Photo title" data-effect="mfp-zoom-in">@T("common.view.photos")</a>
                <a href="/panagea/img/gallery/hotel_list_2.jpg" title="Photo title" data-effect="mfp-zoom-in"></a>
                <a href="/panagea/img/gallery/hotel_list_3.jpg" title="Photo title" data-effect="mfp-zoom-in"></a>
            </span>
        </div>
    </section>
    <!--/hero_in-->

    <div class="bg_color_2">
        <nav class="secondary_nav sticky_horizontal">
            <div class="container">
                <ul class="clearfix p-0">
                    <li><a href="#description" class="active">@T("common.view.description")</a></li>
                    @if (!string.IsNullOrEmpty(Model.Features))
                    {
                        <li><a href="#feature">@T("common.skischool.feature")</a></li>
                    }
                    @if (Model.EquipmentCategoryList.EquipmentCategories.Any())
                    {
                        <li><a href="#equipmentcategories">@T("common.skischool.equipmentcategories")</a></li>
                    }
                    @if (Model.ActivityList.Activities.Any())
                    {
                        <li><a href="#activities">@T("common.skischool.activities")</a></li>
                    }
                    <li><a href="#location">@T("common.skischool.location")</a></li>
                    <li><a href="#reviews">@T("common.skischool.reviews")</a></li>
                    <li><a href="#sidebar">@T("common.view.booking")</a></li>
                </ul>
            </div>
        </nav>
        <div class="container margin_60_35 bg-white border-left border-right">
            <div class="row">
                <div class="col-lg-8">
                    <section id="description">
                        @Html.Raw(Model.ShortBody)
                        <br />
                        @Html.Raw(Model.Body)
                        <hr>
                        @if (!string.IsNullOrEmpty(Model.Features))
                        {
                            <div class="card">
                                <div class="card-header" id="feature">
                                    @T("common.skischool.feature")
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-12">
                                            @Html.Raw(Model.Features)
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <hr>
                        }
                        @if (Model.EquipmentCategoryList.EquipmentCategories.Any())
                        {
                            <div class="card">
                                <div class="card-header" id="equipmentcategories">
                                    @T("common.skischool.equipmentcategories")
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-lg-12">
                                            <div id="equipmentCategory">
                                                @if (Model.EquipmentCategoryList.EquipmentCategories.Any())
                                                {
                                                    foreach (var equipmentCategory in Model.EquipmentCategoryList.EquipmentCategories)
                                                    {
                                                        <div class="card">
                                                            <div class="card-header">
                                                                <a class="card-link d-block collapsed" data-toggle="collapse" href="#ec-@equipmentCategory.Id">
                                                                    @equipmentCategory.Title
                                                                </a>
                                                            </div>
                                                            <div id="ec-@equipmentCategory.Id" class="collapse" data-parent="#equipmentCategory">
                                                                <div class="card-body p-1">
                                                                    @if (equipmentCategory.EquipmentList.Equipments.Any())
                                                                    {
                                                                        foreach (var equipment in equipmentCategory.EquipmentList.Equipments)
                                                                        {
                                                                            <div class="m-1">
                                                                                <span class="bg-dark text-white p-1 w-100 d-block" id="basic-addon3">@equipment.Title</span>
                                                                                <div class="input-group input-group-sm">
                                                                                    <select class=" rounded-0 form-control form-control-sm text-right" id="equipment-@equipment.Id-select">
                                                                                        @foreach (var price in equipment.Prices)
                                                                                        {
                                                                                            <option value="@price.Id">
                                                                                                @price.PriceVariation.Name @(price.PriceParentVariation != null ? price.PriceParentVariation.Name  : "") - @price.Value @_workContext.WorkingCurrency.CurrencyCode
                                                                                            </option>
                                                                                        }
                                                                                    </select>
                                                                                    <span class="input-group-btn">
                                                                                        <button class="btn btn-dark btn-sm addToCart btnDisabled rounded-0" data-selectid="equipment-@equipment.Id-select"><i class="icon_plus"></i> @T("common.add.tocart")</button>
                                                                                    </span>
                                                                                </div>
                                                                            </div>
                                                                        }
                                                                    }
                                                                </div>
                                                            </div>
                                                        </div>
                                                    }
                                                }
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                            <hr>
                        }
                        @if (Model.ActivityList.Activities.Any())
                        {
                            <div class="card">
                                <div class="card-header" id="activities">
                                    @T("common.skischool.activities")
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-lg-12">
                                            <div class="row" id="activity">
                                                @if (Model.ActivityList.Activities.Any())
                                                {
                                                    foreach (var activity in Model.ActivityList.Activities)
                                                    {
                                                        var url = "/" + _workContext.WorkingLanguage.UniqueSeoCode + "/" + activity.SeName;
                                                        var liked = Model.User.WishList.Wishes.Any(o => o.EntityGroup == WCore.Core.Domain.EntityGroup.Activity && o.EntityKey == activity.Id);
                                                        <div class="col-xl-6 col-lg-6 col-md-6 isotope-item popular">
                                                            <div class="box_grid">
                                                                <figure>
                                                                    <a href="#0" data-id="@activity.Id" data-group="@EntityGroup.Activity" class="wish_bt @(liked ? "liked" : "")"></a>
                                                                    <a href="@url"><img src="@activity.Image" class="img-fluid" alt="" width="800" height="533"><div class="read_more"><span>@T("common.readmore")</span></div></a>
                                                                    <small>@Model.Title</small>
                                                                </figure>
                                                                <div class="wrapper">
                                                                    <h3><a href="@url">@activity.Title</a></h3>
                                                                    @if (!string.IsNullOrEmpty(activity.ShortBody))
                                                                    {
                                                                        <p>@(activity.ShortBody.Length > 350 ? activity.ShortBody.Substring(0,350)+"..." : activity.ShortBody)</p>
                                                                    }
                                                                    @if (activity.Prices.Any())
                                                                    {
                                                                        <div class="input-group input-group-sm">
                                                                            <select class=" rounded-0 form-control form-control-sm text-right" id="activity-@activity.Id-select">
                                                                                @foreach (var price in activity.Prices)
                                                                                {
                                                                                    <option value="@price.Id">
                                                                                        @price.PriceVariation.Name @(price.PriceParentVariation != null ? price.PriceParentVariation.Name  : "") - @price.Value @_workContext.WorkingCurrency.CurrencyCode
                                                                                    </option>
                                                                                }
                                                                            </select>
                                                                            <span class="input-group-btn">
                                                                                <button type="button" class="btn btn-dark btn-sm addToCart btnDisabled rounded-0" data-selectid="activity-@activity.Id-select"><i class="icon_plus"></i> @T("common.add.tocart")</button>
                                                                            </span>
                                                                        </div>
                                                                        }
                                                                </div>
                                                                <ul>
                                                                    <li><i class="ti-eye"></i> 0 @T("common.views")</li>
                                                                    <li><div class="score"><span>Superb<em>3 @T("common.reviews") </em></span><strong>8.9</strong></div></li>
                                                                </ul>
                                                            </div>
                                                        </div>
                                                    }
                                                }
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <hr>
                        }
                        @if (Model.Descriptions.Any())
                        {
                            <div class="row">
                                @foreach (var description in Model.Descriptions)
                                {
                                    <div class="col-12 isotope-item popular">
                                        <div class="card">
                                            <div class="card-header" id="description-@description.Id">
                                                @description.Title
                                            </div>
                                            <div class="card-body">
                                                @Html.Raw(description.Body)
                                            </div>
                                        </div>
                                    </div>
                                }
                            </div>
                        }
                        <div class="card">
                            <div class="card-header" id="location">
                                @T("common.skischool.location")
                            </div>
                            <div class="card-body">
                                <div id="map" class="map map_single"></div>
                            </div>
                        </div>
                    </section>

                    @await Component.InvokeAsync("Review", new { entityKey = Model.Id, entityGroup = EntityGroup.SkiSchool })
                </div>
                <aside class="col-lg-4" id="sidebar">
                    @await Component.InvokeAsync("Search")
                    <div class="box_detail booking">
                        <div class="box_style_cat" id="faq_box">
                            <ul id="cat_nav">
                                @if (Model.Descriptions.Any())
                                {
                                    foreach (var description in Model.Descriptions)
                                    {
                                        <li><a href="#description-@description.Id"><i class="icon_document_alt"></i> @description.Title</a></li>
                                    }
                                }
                            </ul>
                        </div>
                        <a href="wishlist.html" class="btn_1 full-width outline wishlist liked"><i class="icon_heart"></i> @T("common.add.towishlist")</a>
                    </div>
                    <ul class="share-buttons">
                        <li><a class="fb-share" href="#0"><i class="social_facebook"></i> @T("common.share")</a></li>
                        <li><a class="twitter-share" href="#0"><i class="social_twitter"></i> @T("common.share")</a></li>
                        <li><a class="gplus-share" href="#0"><i class="social_googleplus"></i> @T("common.share")</a></li>
                    </ul>
                </aside>
            </div>
        </div>
    </div>
</main>
@section Scripts{
    <!-- Map -->
    <script src="http://maps.googleapis.com/maps/api/js?key=AIzaSyApP5AHpxWoetYkls_eEWuXqpx3Fl6PJfg"></script>
    <script src="/panagea/js/map_single_hotel.js"></script>
    <script src="/panagea/js/infobox.js"></script>

    <!-- DATEPICKER  -->
    <script>
        $(function () {
            $('input[name="dates"]').daterangepicker({
                autoUpdateInput: false,
                parentEl: '.scroll-fix',
                minDate: new Date(),
                opens: 'left',
                locale: {
                    cancelLabel: 'Clear'
                }
            });
            $('input[name="dates"]').on('apply.daterangepicker', function (ev, picker) {
                $(this).val(picker.startDate.format('MM-DD-YY') + ' > ' + picker.endDate.format('MM-DD-YY'));
            });
            $('input[name="dates"]').on('cancel.daterangepicker', function (ev, picker) {
                $(this).val('');
            });
        });</script>

    <!-- INPUT QUANTITY  -->
    <script src="/panagea/js/input_qty.js"></script>
}

@section Styles{
    <style>
        .hero_in.hotels_detail::before {
            background-size: cover;
            background-image: url(@(string.IsNullOrEmpty(Model.Image) ? "/panagea/img/hero_in_hotels_detail.jpg" : Model.Image)) !important;
            background-position: center;
            background-size: cover;
            background-repeat: no-repeat;
        }
    </style>
}